define("index:widget/poilist/poilist.js",function(t,e,i){var n=t("common:widget/url/url.js"),s="hot_value",r="http://spotshot.baidu.com/getRankHotView.php",a={pn:0,wd:"",init:function(t,e){if(e.main){var i=e.main;this.current_city=e.current_city,this.result=i.result,this.sort_type=i.place_info.d_sort_type||s,this.wd=this.result.wd,this.pn=this.result.page_num,this._bind(),this._setStatus(),this._updateTime()}},_setStatus:function(){listener.trigger("common.page","city_change",{cityInfo:this.current_city})},_bind:function(){var t=this;$("#sel_city_form").delegate("input","click",function(e){t._updateSort(e)}),$(".index-list-title em").click(function(e){t._updateAll(e)}),$("ul.index-list-content").delegate("li","click",function(e){t.showDetail(e)})},_updateTime:function(){var t=$(".title-right .upd-time"),e=this.current_city.name,i=r+"?poiname="+e+"&time="+parseInt((new Date).getTime()/1e3);$.ajax({url:i,context:this,dataType:"jsonp"}).done(function(e){if(e&&e.userTime){var i=e.userTime.split(" "),n=i[1].split(":");t.text(n[0]+":"+n[1])}})},_updateSort:function(t){var e=t.target,i=$(e).val()||s,n=this.current_city.code,r=this.result.wd,a={qt:"s",c:n,wd:r,pn:0,pl_sort_type:i};this._request(a,{replace:!0}),this.sort_type=i,ccStat("sort_type",{type:i})},_updateAll:function(){var t=this.current_city.code,e=this.result.wd,i=Math.ceil((new Date).getTime()/1e3),n={qt:"s",c:t,wd:e,pn:0,t:i};this._request(n,{replace:!0})},showDetail:function(t){var e,i,s=t.target||t.srcElement;e="li"===s.tagName.toLowerCase()?s:$(s).parentsUntil("ul.index-list-content","li"),i=$(e).attr("data-uid"),n.update({module:"index",action:"detail",query:{qt:"inf",uid:i}},{queryReplace:!0,replace:!0})},_request:function(t,e){n.update({module:"index",action:"search",query:t},e)}};i.exports=a});