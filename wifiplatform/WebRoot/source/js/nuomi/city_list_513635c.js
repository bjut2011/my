function sugInit(){var t,i=require("common:widget/ui/suggestion/suggestion.js"),e="J-select-city-form",n=$("#"+e),s=['<a href="${link}" data-kw="${short_name}">','<span class="fl">${short_name}</span>','<span class="fr">${city_url}</span>',"</a>"].join(""),a=['<a href="${link}" data-kw="${short_name}" class="hover">','<span class="fl">${short_name}</span>','<span class="fr">${city_url}</span>',"</a>"].join("");t=new i("#"+e,{delay:100,zIndex:101,url:"/pcindex/main/citysug",className:"select-city-list",activeItemClass:"hover",itemTem:s,formatParam:function(t){return{kw:t}},formatRespons:function(t){return 0===t.errno&&t.data&&t.data.list?t.data.list:[]},renderItem:function(i){for(var e,n=a,c=s,r=[],o=0,l=i.length;l>o;o++)e=i[o],r.push(0==o?n.replace(/\$\{([^\}]*)\}/g,function(t,i){return e[i]}):c.replace(/\$\{([^\}]*)\}/g,function(t,i){return e[i]}));return 0===r.length&&t.hide(),r.join("")},onconfirm:function(t){location.href=$(t.target).attr("href")},onEnter:function(){$(".select-city-list a").length>0&&(location.href=$(".select-city-list a").eq(0).attr("href"))},onActiveItem:function(t){var i=$(t.target);$(".select-city-list a").siblings(".hover").removeClass("hover"),i.addClass("hover"),n.val(i.data("kw"))}})}var cityList={init:function(){this.province=$("#J-province"),this.city=$("#J-city"),this.selectCityBtn=$("#J-select-city-btn"),this.selectForm=$("#J-select-form"),this.cityList=$("#J-city-list .city-list"),this.selectCityList=$("#J-select-city-list"),this.isShow=!1,this.url="",this.bindEvents(),sugInit();var t=$("#J-province option:selected").val();this.renderCity(t)},bindEvents:function(){var t=this;t.cityList.on({mouseover:function(){$(this).addClass("city-list-hover")},mouseout:function(){$(this).removeClass("city-list-hover")}}),t.province.change(function(){var i=$("#J-province option:selected").val();statistics($("#J-province option:selected").text(),"",1);$("#J-city").html("");$("#id_cityname").html($("#J-province option:selected").text());t.renderCity(i)}),t.city.change(function(){t.url=$("#J-city option:selected").data("url"),statistics($("#J-province option:selected").text(),$("#J-city option:selected").text(),2),t.selectCityBtn.attr("href","mall!awifi.do?city="+$("#J-city option:selected").text()+"&province="+$("#J-province option:selected").text())})},renderCity:function(t){var i=this;$.ajax({type:"post",url:"mall!GetCity",dataType:"json",data:{pid:t},success:function(t){if(0==t.errno)if(t.data.list.length>0){var e="";$.each(t.data.list,function(t,n){""==e&&(i.url=n.link,$("#id_cityname").html("请选择"),e="<option value=''>"+"请选择"+"</option>",$("#id_city").attr("href","mall!awifi.do?city="+n.city_name+"&province="+$("#J-province option:selected").text()),i.selectCityBtn.attr("href","mall!awifi.do?city="+n.city_name+"&province="+$("#J-province option:selected").text())),e+="<option value='"+n.city_code+"' data-url='"+n.link+"'>"+n.city_name+"</option>"}),i.city.html(e),setTimeout(function(){i.city.find("option").eq(0).attr("selected",!0)},1),i.city.hasClass("hide")&&i.city.removeClass("hide")}else i.city.addClass("hide")}})}};cityList.init();